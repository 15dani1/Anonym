(this.webpackJsonpAnonym=this.webpackJsonpAnonym||[]).push([[0],{1032:function(e,t,a){},1090:function(e,t,a){},1134:function(e,t,a){},1137:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(5),l=a.n(s),o=a(1164),c=(a(523),a(7)),i=a.n(c),u=a(26),m=a(32),d=a(33),p=a(60),h=a(41),E=a(40),f=a(20),v=a(113),g=a(114),b=a(1149),w=(a(792),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"postPreview"},r.a.createElement(b.a,{to:this.props.postId},r.a.createElement("div",{className:"postTitle"},this.props.postTitle)),r.a.createElement("div",{className:"tagline"},this.props.tagline),r.a.createElement("div",{className:"previewContainer"},r.a.createElement("div",{className:"date"},new Date(this.props.createdAt).toLocaleString()),r.a.createElement("div",{className:"text"},this.props.text),r.a.createElement("div",{className:"previewText"})))}}]),a}(r.a.Component)),O=a(95),S=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"afterFetch",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.findById(this.attrs.post_id);case 2:this.post=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),a}(O.Model);S.className="Contestation",S.DIRECTION_TAKE_DOWN=0,S.DIRECTION_KEEP=1,S.STATUS_PENDING=0,S.STATUS_COMPLETED=1,S.schema={post_id:{type:String,decrypted:!0,required:!0},amount:{type:Number,decrypted:!0,required:!0},direction:{type:Number,decrypted:!0,required:!0},wallet_address:{type:String,decrypted:!0,required:!0},status:{type:Number,decrypted:!0}},S.defaults={status:S.STATUS_PENDING};var y=S,N=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"afterFetch",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.contestations=[],e.next=3,y.fetchList({post_id:this._id});case 3:this.contestations=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),a}(O.Model);N.className="PostObj",N.STATE_UNCONTESTED=0,N.STATE_CONTESTED=1,N.STATE_REMOVED=2,N.TYPE_POST=0,N.TYPE_COMMENT=1,N.schema={username:String,title:{type:String,decrypted:!0,required:!0},tagline:{type:String,decrypted:!0,required:!0},excerpt:{type:String,decrypted:!0,required:!0},fileId:{type:String,decrypted:!0,required:!0},author_wallet:{type:String,decrypted:!0,required:!0},state:{type:Number,decrypted:!0,required:!0},betDelta:{type:Number,decrypted:!0},objType:{type:Number,decrypted:!0,required:!0},post_id:{type:String,decrypted:!0}},N.defaults={state:N.STATE_UNCONTESTED,objType:N.TYPE_POST,betDelta:0};var C=N,T=(a(180),a(1168)),k=a(1156),j=a(68),x=a(133),D=a(1159),_=a(1165),A=function(e){var t=e.userData,a=e.handleSignOut,n=e.history,s=e.showModal,l=r.a.useState(!1),o=Object(f.a)(l,2),c=o[0],m=o[1],d=r.a.useState(t.username),p=Object(f.a)(d,2),h=p[0],E=(p[1],r.a.useState(new v.Person(t.profile))),O=Object(f.a)(E,2),S=O[0],y=(O[1],r.a.useState([])),N=Object(f.a)(y,2),A=N[0],M=N[1],P=(Object(g.useConnect)().authOptions.userSession,function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,C.fetchOwnList();case 3:t=e.sent,M(t),m(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return r.a.useEffect((function(){P()}),[h]),r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(T.a,{offsetTop:5},r.a.createElement(k.a,{onBack:function(){n.goBack()},title:r.a.createElement(b.a,{to:"/"},r.a.createElement("div",{className:"websiteNameSmall"}," \xa0\xa0 Anonym")),extra:[r.a.createElement(b.a,{to:"/create"},r.a.createElement(j.a,{shape:"round"},"Create New Post")),r.a.createElement(j.a,{shape:"round",onClick:s},"Wallet"),r.a.createElement(x.a,{title:t?t.username:"Not currently logged in"},r.a.createElement(b.a,{to:"/profile"},r.a.createElement(j.a,{shape:"round"},"Profile")))]})),r.a.createElement("div",{className:"container-fluid",style:{height:"100%",margin:"auto",width:"80%"}},r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-offset-3 col-md-6"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"avatar-section"},r.a.createElement("img",{src:S.avatarUrl()?S.avatarUrl():"https://s3.amazonaws.com/onename/avatar-placeholder.png",className:"img-rounded avatar",id:"avatar-image",alt:""}),r.a.createElement("div",{className:"username"},r.a.createElement("h1",null,r.a.createElement("span",{id:"heading-name"},S.name()?S.name():"Anonymous User")),r.a.createElement("span",null,r.a.createElement(D.a,null,r.a.createElement(_.a,null,h),"\xa0|\xa0\xa0\xa0",r.a.createElement(j.a,{size:"medium",danger:!0,onClick:a.bind(void 0)},"Logout")))))),r.a.createElement("div",{className:"col-md-offset-6 col-md-1 float-right"}),r.a.createElement("div",{className:"feed"},r.a.createElement("div",{className:"hottest"},"YOUR POSTS"),c&&r.a.createElement("span",null,"Loading..."),A.map((function(e){return r.a.createElement(w,{postId:"/"+e._id,postTitle:e.attrs.title,tagline:e.attrs.tagline,text:e.attrs.excerpt,createdAt:e.attrs.createdAt})})))))))},M=a(500),P=a.n(M),I=function(){var e=Object(g.useConnect)().doOpenAuth;return r.a.createElement("div",{className:"panel-landing",id:"section-1"},r.a.createElement("div",{className:"websiteName"},"Anonym"),r.a.createElement("img",{src:P.a,alt:"Logo"}),r.a.createElement("p",{className:"lead"},r.a.createElement(j.a,{type:"primary",onClick:function(){return e()}},"Sign In with Blockstack")))},U=a(1166),W=a(1167),B=a(1150),L=a(1162),R=a(1161),z=a(1151),q=a(1152),H=a(237),F=a.n(H),V=a(1169),Y=a(192),G=a.n(Y),K=a(1157),J=(a(925),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={wallet:null,newWallet:!1,balance:"loading..."},n.state.wallet=e.wallet,null!==e.wallet&&n.getBalance(),n.createWallet=n.createWallet.bind(Object(p.a)(n)),n.loadWallet=n.loadWallet.bind(Object(p.a)(n)),n}return Object(d.a)(a,[{key:"createWallet",value:function(){var e=new G.a;this.setState({wallet:e,newWallet:!0}),console.log(e.mnemonic),this.props.setWallet(e)}},{key:"loadWallet",value:function(e){console.log(e);var t=new G.a(e.mnemonic);this.setState({wallet:t}),this.getBalance(),this.props.setWallet(t)}},{key:"getBalance",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.state.wallet.getBalance();case 3:e.t1=e.sent,e.t2={balance:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.wallet,t=this.state.newWallet;return r.a.createElement("div",null,t?r.a.createElement("div",null,r.a.createElement("div",{className:"warning"},"This is your 12 word mnemonic. Save it somewhere and don't share it!"),r.a.createElement("div",{className:"mnemonic"},this.state.wallet.mnemonic)):e?r.a.createElement("div",null,"Current wallet balance: ",this.state.balance):r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(j.a,{type:"primary",onClick:this.createWallet},"Create A New BCH Wallet")),r.a.createElement("p",null," or "),r.a.createElement(K.a,{name:"basic",onFinish:this.loadWallet,onFinishFailed:this.onFinishFailed},r.a.createElement(K.a.Item,{name:"mnemonic",rules:[{pattern:/^([A-Za-z]+\ ){11}([A-Za-z]+)$/,required:!0,message:"Please input a 12 word mnemonic!"}]},r.a.createElement(L.a,{placeholder:"Enter your 12 word mnemonic"})),r.a.createElement(K.a.Item,null,r.a.createElement("p",null,r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Use my Existing BCH Wallet"))))))}}]),a}(r.a.Component)),Z=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),s=a[0],l=a[1],o=Object(n.useState)(""),c=Object(f.a)(o,2),m=c[0],d=c[1],p=Object(n.useState)(""),h=Object(f.a)(p,2),E=h[0],w=h[1],O=Object(n.useState)(""),S=Object(f.a)(O,2),y=S[0],N=S[1],D=Object(n.useState)(""),_=Object(f.a)(D,2),A=_[0],M=_[1],P=B.a.Header,I=B.a.Content,U=(B.a.Footer,L.a.TextArea),W=Object(g.useConnect)().authOptions.userSession,H=function(){var t=Object(u.a)(i.a.mark((function t(){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(v.makeUUID4)().split("-").slice(-1)[0]+".md",console.log("Saving Post Titled "+a),n=new C({username:e.userData.username,title:m,tagline:E,excerpt:A,fileId:a,author_wallet:e.wallet.cashAddress}),t.next=5,n.save();case 5:return t.next=7,W.putFile(a,y,{encrypt:!1});case 7:R.a.success("Post submitted!");case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return null!==e.wallet||e.isVisible||e.showModal(),r.a.createElement("div",{className:"wrapper"},r.a.createElement(T.a,{offsetTop:5},r.a.createElement(k.a,{onBack:function(){e.history.goBack()},title:r.a.createElement(b.a,{to:"/"},r.a.createElement("div",{className:"websiteNameSmall"}," \xa0\xa0 Anonym")),extra:[r.a.createElement(b.a,{to:"/create"},r.a.createElement(j.a,{shape:"round"},"Create New Post")),r.a.createElement(j.a,{shape:"round",onClick:e.showModal},"Wallet"),r.a.createElement(x.a,{title:e.userData?e.userData.username:"Not currently logged in"},r.a.createElement(b.a,{to:"/profile"},r.a.createElement(j.a,{shape:"round"},"Profile")))]})),r.a.createElement("div",{style:{width:"100%",height:"100%"}},r.a.createElement(B.a,{className:"feed",hasSider:!1,style:{margin:"auto","background-color":"white"}},r.a.createElement(P,{style:{"background-color":"white"}},r.a.createElement("div",{className:"postTitle"},"Create New Post")),r.a.createElement(I,{style:{margin:"auto"}},r.a.createElement(z.a,{direction:"vertical",size:"large"},r.a.createElement(L.a,{size:"large",placeholder:"Title",prefix:r.a.createElement(V.a,null),style:{width:400},onChange:function(e){return d(e.target.value)}}),r.a.createElement(L.a,{size:"medium",placeholder:"Tagline",prefix:r.a.createElement(V.a,null),style:{width:600},onChange:function(e){return w(e.target.value)}}),r.a.createElement(L.a,{size:"medium",placeholder:"Excerpt",prefix:r.a.createElement(V.a,null),style:{width:600},onChange:function(e){return M(e.target.value)}}),r.a.createElement(q.default.Group,{defaultValue:"Markdown",buttonStyle:"solid"},r.a.createElement(q.default.Button,{onChange:function(){return l(!1)},value:"Markdown"},"Markdown"),r.a.createElement(q.default.Button,{onChange:function(){return l(!0)},value:"Render"},"Render")),s?r.a.createElement(F.a,{source:y}):r.a.createElement(U,{value:y,onChange:function(e){return N(e.target.value)},placeholder:"Enter Text Here",style:{width:800},autoSize:{minRows:10,maxRows:30}}),r.a.createElement(j.a,{size:"large",onClick:H},"Submit"))))))},$=(a(1032),a(1155)),Q=a(1163),X=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={isLoading:!0,posts:[]},n.fetchData=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.fetchList({objType:C.TYPE_POST});case 2:t=e.sent,n.setState({isLoading:!1,posts:t,searchInput:""});case 4:case"end":return e.stop()}}),e)}))),n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"homepage"},r.a.createElement(T.a,{offsetTop:5},r.a.createElement(k.a,{title:r.a.createElement(b.a,{to:"/"},r.a.createElement("div",{className:"websiteNameSmall"}," \xa0\xa0 Anonym")),extra:[r.a.createElement(b.a,{to:"/create"},r.a.createElement(j.a,{shape:"round"},"Create New Post")),r.a.createElement(j.a,{shape:"round",onClick:this.props.showModal},"Wallet"),r.a.createElement(x.a,{title:this.props.userData?this.props.userData.username:"Not currently logged in"},r.a.createElement(b.a,{to:"/profile"},r.a.createElement(j.a,{shape:"round"},"Profile")))]})),r.a.createElement("div",{className:"websiteName"},"Anonym"),r.a.createElement("div",{style:{marginTop:"60px"}},r.a.createElement($.a,{value:this.state.searchInput,height:40,placeholder:"Search posts...",width:"876px",style:{borderRadius:"50px"},onChange:function(t){return e.setState({searchInput:t.target.value})}})),r.a.createElement("div",{className:"feed"},r.a.createElement("div",{className:"hottest"},"HOTTEST POSTS"),this.state.isLoading&&r.a.createElement("span",null,"Loading..."),this.state.posts.map((function(t){return new RegExp(e.state.searchInput,"i").test(t.attrs.title)||new RegExp(e.state.searchInput,"i").test(t.attrs.tagline)||new RegExp(e.state.searchInput,"i").test(t.attrs.excerpt)?r.a.createElement(w,{postId:"/"+t._id,createdAt:t.attrs.createdAt,postTitle:t.attrs.title,tagline:t.attrs.tagline,text:t.attrs.excerpt}):null}))),r.a.createElement(Q.a,null),r.a.createElement("strong",{className:"site-back-top-basic"}))}},{key:"componentDidMount",value:function(){this.fetchData()}}]),a}(r.a.Component),ee=a(1158),te=(a(1090),a(1153)),ae=a(1154),ne=a(493),re=a(1170),se=a(1160),le=a(506),oe=a.n(le),ce=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={hasContested:!0,bitcoinToUsd:9093,contestationAmount:0},n.createContestation=n.createContestation.bind(Object(p.a)(n)),oe.a.get("https://min-api.cryptocompare.com/data/pricemulti?fsyms=BTC,&tsyms=USD").then((function(e){console.log(e.data),n.setState({bitcoinToUsd:e.data.BTC.USD})})),n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},"This post is being contested.")),this.state.hasContested?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},"You have already contested this post")):r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(se.a,{dots:!0,defaultValue:0,tipFormatter:function(e){return r.a.createElement("div",null,e," Satoshis ")},max:12e4,step:100,onChange:function(t){return e.setState({contestationAmount:t})}}),r.a.createElement(L.a,{disabled:!0,size:"large",value:Math.round(this.state.contestationAmount*this.state.bitcoinToUsd/1e6)/100,addonBefore:"$",onChange:function(t){return e.setState({contestationAmount:t.target.value})}}))),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement(j.a,{size:"large",className:"btn-success",onClick:function(){return e.createContestation(y.DIRECTION_KEEP)}},"Keep Up")),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(j.a,{size:"large",className:"btn-danger",onClick:function(){return e.createContestation(y.DIRECTION_TAKE_DOWN)}},"Take Down")))))}},{key:"setHasContested",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchOwnList({post_id:this.props.post._id});case 2:t=e.sent,this.setState({hasContested:0!==t.length});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createContestation",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var a,n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new y({post_id:this.props.post._id,amount:parseFloat(this.state.contestationAmount),direction:t,wallet_address:this.props.wallet}),e.next=3,a.save();case 3:return n=this.props.post,r=Math.max.apply(Math,n.contestations.map((function(e){return e.attrs.updatedAt}))),s=Date.now()-r,n.update({betDelta:s}),e.next=9,n.save();case 9:this.setState({hasContested:!0}),R.a.success("Thank you for your opinion");case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.setHasContested()}}]),a}(r.a.Component),ie=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;Object(m.a)(this,a),(n=t.call(this,e)).handleOk=function(e){console.log(e),n.setState({isModalVisible:!1})},n.handleCancel=function(e){console.log(e),n.setState({isModalVisible:!1})};var r=e.match.params.postId;n.beginContestation=n.beginContestation.bind(Object(p.a)(n)),n.submitComment=n.submitComment.bind(Object(p.a)(n));var s=Object(O.getConfig)().userSession,l=s.loadUserData();return n.state={userData:l,isLoading:!0,comments:[],post:null,text:null,title:null,date:null,tagline:null,animals:["alligator","anteater","armadillo","auroch","axolotl","badger","bat","bear","beaver","blobfish","buffalo","camel","chameleon","cheetah","chipmunk","chinchilla","chupacabra","cormorant","coyote","crow","dingo","dinosaur","dog","dolphin","dragon","duck","octopus","elephant","ferret","fox","frog","giraffe","goose","gopher","grizzly","hamster","hedgehog","hippo","hyena","jackal","jackalope","ibex","ifrit","iguana","kangaroo","kiwi","koala","kraken","lemur","leopard","liger","lion","llama","manatee","mink","monkey","moose","narwhal","nyan cat","orangutan","otter","panda","penguin","platypus","python","pumpkin","quagga","quokka","rabbit","raccoon","rhino","sheep","shrew","skunk","squirrel","tiger","turtle","unicorn","walrus","wolf","wolverine","wombat"],wallet:e.wallet,currentComment:null,isModalVisible:!1,contestedPost:null},n.fetchPost=Object(u.a)(i.a.mark((function e(){var t,a,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.findById(r);case 2:return t=e.sent,console.log(t.attrs.state),e.next=6,s.getFile(t.attrs.fileId,{decrypt:!1});case 6:return a=e.sent,n.setState({isLoading:!0,title:t.attrs.title,tagline:t.attrs.tagline,date:new Date(t.attrs.createdAt).toLocaleString(),text:a,post:t}),e.next=10,y.fetchOwnList({post_id:t._id});case 10:l=e.sent,n.setState({hasContested:0!==l.length}),n.fetchComments();case 13:case"end":return e.stop()}}),e)}))),n.fetchComments=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n.state.post){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C.fetchList({objType:C.TYPE_COMMENT,post_id:n.state.post._id});case 4:t=e.sent,n.setState({comments:t});case 6:case"end":return e.stop()}}),e)}))),n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(T.a,{offsetTop:5},r.a.createElement(k.a,{onBack:function(){e.props.history.goBack()},title:r.a.createElement(b.a,{to:"/"},r.a.createElement("div",{className:"websiteNameSmall"}," \xa0\xa0 Anonym")),extra:[r.a.createElement(b.a,{to:"/create"},r.a.createElement(j.a,{shape:"round"},"Create New Post")),r.a.createElement(j.a,{shape:"round",onClick:this.props.showModal},"Wallet"),r.a.createElement(x.a,{title:this.props.userData?this.props.userData.username:"Not currently logged in"},r.a.createElement(b.a,{to:"/profile"},r.a.createElement(j.a,{shape:"round"},"Profile")))]})),r.a.createElement(ee.a,{title:"Report Post",visible:this.state.isModalVisible,onOk:this.handleOk,onCancel:this.handleCancel,footer:null},r.a.createElement(ce,{wallet:this.state.wallet,post:this.state.contestedPost})),this.state.post===C.STATE_REMOVED?r.a.createElement("div",{className:"title"},"This Post Has Been Removed"):r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.state.title),r.a.createElement("div",{className:"tagline"},this.state.tagline),r.a.createElement("div",{className:"date"},this.state.date),r.a.createElement("div",{className:"postText"},r.a.createElement(F.a,{source:this.state.text})),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(j.a,{size:"large",className:"btn-danger",onClick:function(){return e.beginContestation(e.state.post)}},"Contest"))))),r.a.createElement(te.a,{orientation:"left"},"Comments"),this.state.comments?this.state.comments.map((function(t){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement(ae.a,{avatar:r.a.createElement(ne.a,{style:{backgroundColor:"#"+((1<<24)*Math.random()|0).toString(16),verticalAlign:"middle"},icon:r.a.createElement(re.a,null)}),author:"Anonymous "+e.state.animals[Math.floor(Math.random()*e.state.animals.length)],content:t.attrs.excerpt,datetime:new Date(t.attrs.createdAt).toLocaleDateString()})),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(j.a,{size:"large",className:"btn-success",onClick:function(){return e.beginContestation(t)}},"Contest"))))})):r.a.createElement("div",null,"No comments"),this.state.userData&&r.a.createElement("div",null,r.a.createElement(L.a,{value:this.state.currentComment,onChange:function(t){return e.setState({currentComment:t.target.value})},placeholder:"Enter Comment Here",style:{width:800},autoSize:{minRows:10,maxRows:30}}),r.a.createElement(j.a,{size:"large",onClick:this.submitComment},"Comment")))}},{key:"componentDidMount",value:function(){this.fetchPost()}},{key:"submitComment",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.wallet){e.next=3;break}return R.a.error("You need to create register a Bitcoin Cash Wallet to report posts"),e.abrupt("return");case 3:return console.log("Saving Comment"),t=new C({username:this.state.userData.username,title:"",tagline:"",excerpt:this.state.currentComment,fileId:"",author_wallet:this.state.wallet.cashAddress,objType:C.TYPE_COMMENT,post_id:this.state.post._id}),e.next=7,t.save();case 7:(a=this.state.comments).unshift(t),this.setState({comments:a}),R.a.success("Post submitted!");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"beginContestation",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.wallet){e.next=3;break}return R.a.error("You need to create register a Bitcoin Cash Wallet to report posts"),e.abrupt("return",!1);case 3:if((a=t).attrs.status!==C.STATUS_UNCONTESTED){e.next=8;break}return a.update({state:C.STATE_CONTESTED}),e.next=8,a.save();case 8:t.attrs.objType===C.TYPE_POST&&this.setState({post:a}),this.setState({contestedPost:a,isModalVisible:!0});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(r.a.Component),ue=new v.AppConfig(["store_write","publish_data"]),me=new v.UserSession({appConfig:ue});Object(O.configure)({apiServer:"http://localhost:1260",userSession:me});var de=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={userData:null,visible:!1,wallet:null},n.runModeration=Object(u.a)(i.a.mark((function e(){var t,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.fetchOwnList({state:C.STATE_CONTESTED});case 2:return e.sent.forEach((function(e){if(Date.now()-e.attrs.updatedAt>=864e5){var t=0,a=0;e.contestations.forEach((function(e){e.status===y.STATUS_PENDING&&(t+=e.amount,e.direction===y.DIRECTION_TAKE_DOWN&&(a+=e.amount))})),a<.66*t?(e.update({state:C.STATE_UNCONTESTED}),e.save()):(e.update({state:C.STATE_REMOVED}),e.save())}})),e.next=6,y.fetchOwnList({status:y.STATUS_PENDING});case 6:return t=e.sent,a=[],t.forEach((function(e){e.status===y.STATUS_PENDING&&e.post.state===C.STATE_UNCONTESTED&&(a.push({address:e.post.author_wallet,amountSat:e.amount}),e.update({status:y.STATUS_COMPLETED}),e.save())})),e.next=11,n.state.wallet.send(a);case 11:r=e.sent,console.log(r.txid);case 13:case"end":return e.stop()}}),e)}))),n.showModal=function(){n.setState({visible:!0})},n.handleOk=function(e){console.log(e),n.setState({visible:!1})},n.handleCancel=function(e){console.log(e),n.setState({visible:!1})},n.handleSignOut=n.handleSignOut.bind(Object(p.a)(n)),n.setWallet=n.setWallet.bind(Object(p.a)(n)),n}return Object(d.a)(a,[{key:"handleSignOut",value:function(e){e.preventDefault(),this.setState({userData:null}),me.signUserOut(window.location.origin),localStorage.clear()}},{key:"setWallet",value:function(e){console.log("foobar"),this.setState({wallet:e,visible:!1}),localStorage.setItem("BCH_MNEMONIC",e.mnemonic),this.runModeration()}},{key:"render",value:function(){var e=this,t=this.state.userData,a={appDetails:{name:"Blockstack App",icon:window.location.origin+"/favicon.ico"},userSession:me,finished:function(t){var a=t.userSession;e.setState({userData:a.loadUserData()}),console.log("Creating Radiks User"),O.User.createWithCurrentUser()}};return r.a.createElement(g.Connect,{authOptions:a},r.a.createElement("div",{className:"site-wrapper"},r.a.createElement("div",{className:"site-wrapper-inner"},r.a.createElement(ee.a,{title:"Wallet",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,footer:null},r.a.createElement(J,{setWallet:this.setWallet,wallet:this.state.wallet})),r.a.createElement(U.a,null,r.a.createElement(W.a,{path:"/create",render:function(a){return t?r.a.createElement(Z,Object.assign({userData:t,wallet:e.state.wallet,handleSignOut:e.handleSignOut,showModal:e.showModal,isVisible:e.state.visible},a)):r.a.createElement(I,null)}}),r.a.createElement(W.a,{path:"/profile",render:function(a){return t?r.a.createElement(A,Object.assign({showModal:e.showModal,userData:e.state.userData,handleSignOut:e.handleSignOut},a)):r.a.createElement(I,null)}}),r.a.createElement(W.a,{path:"/:postId",render:function(a){return t?r.a.createElement(ie,Object.assign({wallet:e.state.wallet,showModal:e.showModal,userData:e.state.userData},a)):r.a.createElement(I,null)}}),r.a.createElement(W.a,{path:"/",render:function(a){return t?r.a.createElement(X,{userData:t,showModal:e.showModal}):r.a.createElement(I,null)}})))))}},{key:"componentDidMount",value:function(){var e=this;console.log("Component Mounted");var t=localStorage.getItem("BCH_MNEMONIC");null!==t&&(console.log("Took wallet mnemonic from local storage!"),this.setWallet(new G.a(t)),console.log(t)),me.isSignInPending()?(console.log("Signing pending"),me.handlePendingSignIn().then((function(t){window.history.replaceState({},document.title,"/"),e.setState({userData:t}),console.log("Hellop")}))):me.isUserSignedIn()&&this.setState({userData:me.loadUserData()})}}]),a}(n.Component);a(1133),a(1134);l.a.render(r.a.createElement(o.a,null,r.a.createElement(de,null)),document.getElementById("root"))},500:function(e,t,a){e.exports=a.p+"static/media/Hat.ef5a97cd.jpg"},518:function(e,t,a){e.exports=a(1137)},537:function(e,t){},539:function(e,t){},550:function(e,t){},552:function(e,t){},563:function(e,t){},565:function(e,t){},673:function(e,t){},729:function(e,t){},792:function(e,t,a){},925:function(e,t,a){}},[[518,1,2]]]);
//# sourceMappingURL=main.138e62d8.chunk.js.map